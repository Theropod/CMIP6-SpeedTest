<!DOCTYPE html>
<html>

<head>
	<link rel="shortcut icon" href="favicon.ico">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, user-scalable=no" />
	<meta charset="UTF-8" />
	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-136276173-2"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag() { dataLayer.push(arguments); }
		gtag('js', new Date());

		gtag('config', 'UA-136276173-2');
	</script>
	<script type="text/javascript">
		// loading access request logs generated by goaccess and insert values in table
		const pageurl = ['/tutorial.html'];
		const access_stat = { 'hitcount': 0, 'hitcount_pctg': 0, 'visitorcount': 0, 'visitorcount_pctg': 0, 'updated:': 'N/A' }
		function insert_access_stat_table(tableid, access_stat) {
			let table = document.getElementById(tableid);
			// Create an empty <tr> element and add it to the 1st position of the table:
			let row = table.insertRow(1);
			// Insert new cells (<td> elements) at the 1st and 2nd position of the "new" <tr> element:
			let cell0 = row.insertCell(0);
			let cell1 = row.insertCell(1);
			let cell2 = row.insertCell(2);
			let cell3 = row.insertCell(3);
			let cell4 = row.insertCell(4);
			// cell value
			cell0.innerHTML = access_stat.hitcount;
			cell1.innerHTML = access_stat.hitcount_pctg.toFixed(2) + '%';
			cell2.innerHTML = access_stat.visitorcount;
			cell3.innerHTML = access_stat.visitorcount_pctg.toFixed(2) + '%';
			cell4.innerHTML = access_stat.updated;
		}
		fetch('access_report.json')
			.then(response => {
				return response.json();
			}).then(access_report => {
				for (const pageacccesslog of access_report.requests.data) {
					if (pageurl.includes(pageacccesslog.data)) {
						access_stat.hitcount += Number(pageacccesslog.hits.count);
						access_stat.hitcount_pctg += Number(pageacccesslog.hits.percent);
						access_stat.visitorcount += Number(pageacccesslog.visitors.count);
						access_stat.visitorcount_pctg += Number(pageacccesslog.visitors.percent);
					}
				}
				access_stat.updated = access_report.general.date_time;
				insert_access_stat_table('access_stat_table', access_stat);
			}).catch(error => {
				console.log(error);
			});
	</script>
	<style type="text/css">
		html,
		body {
			border: none;
			padding-left: 2rem;
			padding-right: 2rem;
			margin: 0;
			background: #FFFFFF;
			color: #202020;
		}

		body {
			text-align: left;
			font-family: "Roboto", sans-serif;
		}

		h1,
		h2,
		h3,
		h4 {
			color: #404040;
		}

		img {
			width: 1000px;
			border: 1px solid grey;
		}

		.logo {
			width: min-content;
			border: 0px ;
		}

		@media all and (max-width:40em) {
			body {
				font-size: 0.8em;
			}
		}

		.topnav {
			overflow: hidden;
			background-color: #333;
		}

		.topnav a {
			float: left;
			color: #f2f2f2;
			text-align: center;
			padding: 14px 16px;
			text-decoration: none;
			font-size: 17px;
		}

		.topnav a:hover {
			background-color: #ddd;
			color: black;
		}

		.topnav a.active {
			background-color: #743481;
			color: white;
		}

		table.access_stat {
			font-family: verdana, arial, sans-serif;
			font-size: 11px;
			color: #333333;
			border-width: 1px;
			border-color: #666666;
			border-collapse: collapse;
			border-width: 0px;
		}

		table.access_stat th {
			border-width: 1px;
			padding: 8px;
			border-style: solid;
			border-color: #666666;
			background-color: #dedede;
		}

		table.access_stat td {
			border-width: 1px;
			padding: 8px;
			border-style: solid;
			border-color: #666666;
			background-color: #ffffff;
		}
	</style>
	<title>CMIP6 Data Download Speed Test - Tutorial</title>
</head>

<body">
	<div class="topnav">
		<a href="index.html" target="_blank">Introduction</a>
		<a class="active" href="tutorial.html" target="_blank">Tutorial</a>
		<a href="test.html" target="_blank">Test</a>
		<a href="test-result.html" target="_blank">Result</a>
		<a href="contact.html" target="_blank">Contact us</a>
	</div>
	<h1>How to run this Speed Test</h1>
	<h2>Step 1 Download, Install and Enable Allow Cors Access Control Extension </h2>
	<h3> 1.1 Install the Extension</h3>
	<p>If you can access <a href='https://chrome.google.com/webstore' target='_blank'>Chrome web store</a>, just search 'Allow CORS' and find 'Allow CORS: Access-Control-Allow-Origin', then install the extension by 
	clicking 'Add to Chrome'</p>
	<img src='./resources/tutorial/CORS-Extension.jpg'>
	<p>If you cannot access Chrome web store, download the extension by clicking the link below, then manually install this extension. You might want to refer to <a href='https://www.howtogeek.com/120743/how-to-install-extensions-from-outside-the-chrome-web-store/' target='_blank'> this tutorial </a> about how to manually install extension on Chrome.</p>
	<a href='./resources/tutorial/allow-cors-access-control.crx'>download the extension here</a>
	<br></br>
	<img src='./resources/tutorial/install-allow-cors-extension.gif'>
	<h3> 1.2 Activate the Extension</h3>
	<p>Activate the extension by clicking 'Toggle ON|OFF' (Please see the GIF below)</p>
	<img src='./resources/tutorial/activate-allow-cors-extension.gif'>
	<h2>Step 2. Test all </h2>
	<p>Enter <a href='./test.html' target="_blank">the speedtest page</a>, and click 'test
		all' to run the test. You
		can also select any node you like and test its downloading speed by clicking 'test selected'. There will be an
		alert when all tests compelete</p>
	<img src='./resources/tutorial/test-all.gif'>
	<h2>Step 3. Get Result </h2>
	<p>The test result will be shown as a table, and ID of each test is provided in the 'Result URL' column </p>
	<img src='./resources/tutorial/testresult.png'>
	<h2>Step 4.Remove the Extension</h2>
	<p>Since this extension is only designed for development, for security reasons, please remove "Allow CORS" Chrome
		extension after the test by right clicking the
		extension icon and select "Remove from Chrome".
	</p>
	<div id='access_stat_area'>
		<h5 onclick="document.getElementById('access_stat_table').style='display:auto'">Show Access Stat</h5>
		<table id='access_stat_table' class='access_stat' border="1" style="display:none">
			<tr>
				<th>Hits Count</th>
				<th>Hits Count Percentage</th>
				<th>Visitors Count</th>
				<th>Visitors Count Percentage</th>
				<th>Updated:</th>
			</tr>
		</table>
	</div>
	<a href='https://www.tsinghua.edu.cn/publish/ess/' target="_blank"> <img src='./resources/tutorial/logo.png'
		class='logo'></img></a>
	</body>

</html>